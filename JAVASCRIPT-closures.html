<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Fechamentos em JS</title>
</head>
<body>
	<p id="demo"></p>

	<script>
		/*A function can access all variables defined inside the function.*/
		function myFunction(){
			var a = 4;
			return a * a;
		}

		/*But a function can also access variables defined outside the function.*/
		var a = 4;
		function myFunction(){
			return a * a;
		}

		/*In the last example, a is a global variable.
		In a web page, global variables belong to the window object.
		Global variables can be used (and changed) by all scripts in the page (and in the window).
		In the first example, a is a local variable.
		A local variable can only be used inside the function where it is defined. It is hidden from other functions and other scripting code.
		Global and local variables with the same name are different variables. Modifying one, does not modify the other.
		Variables created without the keyword var, are always global, even if they are created inside a function.*/

		/*Global variables live as long as your application (your window / your web page) lives.
		Local variables have short lives. They are created when the function is invoked, and deleted when the function is finished.*/

		/*Suppose you want to use a variable for counting something, and you want this counter to be available to all functions.
		You could use a global variable, and a function to increase the counter.*/
		var counter = 0;

		function add(){
			counter += 1;
		}

		add();
		add();
		add();
		document.getElementById("demo").innerHTML = counter;

		/*There is a problem with the solution above: Any code on the page can change the counter, without calling add().
		The counter should be local to the add() function, to prevent other code from changing it*/
		/*It did not work because we display the global counter instead of the local counter.
		We can remove the global counter and access the local counter by letting the function return it.*/
		/*It did not work because we reset the local counter every time we call the function.
		A JavaScript inner function can solve this.*/

		/*All functions have access to the global scope.  
		In fact, in JavaScript, all functions have access to the scope "above" them.
		JavaScript supports nested functions. Nested functions have access to the scope "above" them.*/
		
		/*The variable add is assigned the return value of a self-invoking function.
		The self-invoking function only runs once. It sets the counter to zero (0), and returns a function expression.
		This way add becomes a function. The "wonderful" part is that it can access the counter in the parent scope.
		This is called a JavaScript closure. It makes it possible for a function to have "private" variables.
		The counter is protected by the scope of the anonymous function, and can only be changed using the add function.
		A closure is a function having access to the parent scope, even after the parent function has closed.*/
	</script>
</body>
</html>